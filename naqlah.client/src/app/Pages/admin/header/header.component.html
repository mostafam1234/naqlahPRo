<!-- header.component.html -->
<header class="custom-navBar flex justify-between items-center sticky top-0 bg-white shadow-md">
  <div class="custom-container">
    <div class="header flex gap-[10px] md:gap-[15px] items-center w-full justify-between">

      <!-- Hamburger Icon -->
      <div class="humburgerIcon" (click)="AppearSideBar()">
        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30">
          <rect x="4" y="6" width="22" height="2" fill="#106490"/>
          <rect x="4" y="13" width="22" height="2" fill="#106490"/>
          <rect x="4" y="20" width="22" height="2" fill="#106490"/>
        </svg>
      </div>

      <!-- Date Section (Hidden on mobile) -->
      <div class="header-date hidden md:inline-block">
        icon
      </div>

      <!-- Search Section (Hidden on mobile) -->
      <div class="header-search hidden md:inline-block">
        <form>
          <input
            type="text"
            id="search"
            class="w-[318px] h-[48px] bg-gray-50 border border-gray-300 text-gray-900 text-sm focus:ring-blue-500 focus:border-blue-500 block p-2.5 rounded-lg transition-all duration-200"
            placeholder="Search"
          />
        </form>
      </div>

      <!-- User Settings Section -->
      <div class="header-user_settings flex gap-[12px] items-center">

        <!-- Settings Dropdown -->
        <div class="relative inline-block text-left settings-dropdown-container">
          <!-- Settings Button -->
          <button
            (click)="toggleSettingsDropdown()"
            class="dropdown-button relative flex items-center justify-center w-12 h-12 bg-white rounded-full shadow-lg hover:shadow-xl transition-all duration-300 group border border-gray-100 hover:border-gray-200"
            [class.active]="settingsDropdownOpen"
          >
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              class="transition-all duration-300 group-hover:scale-110"
              [@settingsRotation]="settingsIconState"
            >
              <path
                d="M14.7354 1.9209C15.1084 1.2565 15.8636 1.07755 16.415 1.4248V1.42578L16.4268 1.43262L18.502 2.69043V2.69141C19.2313 3.13324 19.5148 4.15949 19.0703 4.98535C18.4573 6.11888 18.3215 7.30683 18.8428 8.26172C19.3723 9.23164 20.4436 9.71578 21.709 9.71582C22.5102 9.71582 23.2411 10.4291 23.25 11.3877V13.6191C23.2498 14.5788 22.5157 15.2842 21.7207 15.2842C20.4559 15.2843 19.3835 15.7681 18.8555 16.7393C18.3679 17.636 18.4612 18.7369 18.9854 19.8047L19.0957 20.0176C19.537 20.8283 19.2563 21.8662 18.5264 22.3086L18.5254 22.3096L16.4502 23.5674L16.4395 23.5742C15.8879 23.922 15.1319 23.7439 14.7588 23.0791L14.6309 22.8447C14.0156 21.7196 13.093 20.958 11.9951 20.958C10.8971 20.9582 9.97845 21.7198 9.36914 22.8447L9.24121 23.0791C8.86809 23.7439 8.11209 23.922 7.56055 23.5742L7.5498 23.5674L5.47461 22.3096L5.47363 22.3086C4.74536 21.8672 4.46202 20.8428 4.9043 20.0176C5.52385 18.8845 5.66454 17.6957 5.14453 16.7393C4.61651 15.7681 3.54405 15.2843 2.2793 15.2842C1.47728 15.2842 0.750186 14.5713 0.75 13.6191V11.3809C0.750187 10.4212 1.4843 9.71582 2.2793 9.71582C3.54392 9.71571 4.61638 9.23181 5.14453 8.2627C5.63234 7.36727 5.5385 6.26897 5.01367 5.20605L4.90332 4.99316C4.46169 4.16663 4.74739 3.13161 5.47363 2.69141L5.47461 2.69043L7.5498 1.43262L7.56055 1.42578C8.11635 1.07528 8.86233 1.2623 9.20996 1.90918L9.21289 1.91309L9.34473 2.15527C9.96003 3.2805 10.8826 4.04197 11.9805 4.04199C13.0788 4.04199 13.9971 3.27963 14.6064 2.1543L14.6074 2.15527L14.7354 1.9209ZM11.9941 7.61816C9.39244 7.61816 7.3457 9.85185 7.3457 12.5C7.3457 15.1481 9.39244 17.3818 11.9941 17.3818C14.5958 17.3818 16.6416 15.1481 16.6416 12.5C16.6416 9.8519 14.5958 7.61824 11.9941 7.61816Z"
                stroke="#234A43"
                stroke-width="1.5"
                class="group-hover:stroke-blue-500 transition-colors duration-300"
              />
            </svg>
          </button>

          <!-- Settings Dropdown Menu -->
          <div
            *ngIf="settingsDropdownOpen"
            class="dropdown-menu absolute right-0 mt-2 w-80 bg-white rounded-2xl shadow-2xl border border-gray-100 z-50 overflow-hidden"
            [@dropdownAnimation]
            (click)="onDropdownClick($event)"
          >
            <!-- Header -->
            <div class="dropdown-header dropdown-header px-6 py-4 text-black">
              <h3 class="text-lg font-semibold flex items-center gap-3">
                <svg width="20" height="20" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"/>
                </svg>
                {{ 'ADMIN.HEADER.SETTINGS' | translate }}
              </h3>
            </div>

            <!-- Menu Items -->
            <div class="dropdown-content py-2">
              <div class="dropdown-section px-6 py-3 border-b border-gray-100">
                <h4 class="section-title text-sm font-medium text-gray-500 mb-3">{{ 'ADMIN.HEADER.PROFILE_SECTION' | translate }}</h4>
                <div class="space-y-1">
                  <!-- Profile Button -->
                  <button
                    (click)="handleMenuClick('profile')"
                    class="dropdown-item w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition-all duration-200 group"
                  >
                    <svg class="item-icon w-5 h-5 text-gray-400 group-hover:text-blue-500 transition-colors flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
                    </svg>
                    <span>{{ 'ADMIN.HEADER.PROFILE' | translate }}</span>
                    <svg class="arrow-icon w-4 h-4 ml-auto text-gray-300 group-hover:text-blue-400 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                  </button>

                  <!-- Change Password Button -->
                  <button
                    (click)="handleMenuClick('change_password')"
                    class="dropdown-item w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition-all duration-200 group"
                  >
                    <svg class="item-icon w-5 h-5 text-gray-400 group-hover:text-blue-500 transition-colors flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"></path>
                    </svg>
                    <span>{{ 'ADMIN.HEADER.CHANGE_PASSWORD' | translate }}</span>
                    <svg class="arrow-icon w-4 h-4 ml-auto text-gray-300 group-hover:text-blue-400 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                  </button>

                  <!-- Account Info Button -->
                  <button
                    (click)="handleMenuClick('account_info')"
                    class="dropdown-item w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition-all duration-200 group"
                  >
                    <svg class="item-icon w-5 h-5 text-gray-400 group-hover:text-blue-500 transition-colors flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                    </svg>
                    <span>{{ 'ADMIN.HEADER.ACCOUNT_INFO' | translate }}</span>
                    <svg class="arrow-icon w-4 h-4 ml-auto text-gray-300 group-hover:text-blue-400 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                  </button>
                </div>
              </div>

              <!-- System Section -->
              <div class="dropdown-section px-6 py-3">
                <h4 class="section-title text-sm font-medium text-gray-500 mb-3">{{ 'ADMIN.HEADER.SYSTEM_SECTION' | translate }}</h4>
                <div class="space-y-1">
                  <!-- Help & Support Button -->
                  <button
                    (click)="handleMenuClick('help')"
                    class="dropdown-item w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-700 hover:bg-red-50 hover:text-red-600 rounded-lg transition-all duration-200 group"
                  >
                    <svg class="item-icon w-5 h-5 text-gray-400 group-hover:text-red-500 transition-colors flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path>
                    </svg>
                    <span>{{ 'ADMIN.HEADER.HELP_SUPPORT' | translate }}</span>
                  </button>

                  <!-- About App Button -->
                  <button
                    (click)="handleMenuClick('about')"
                    class="dropdown-item w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-700 hover:bg-red-50 hover:text-red-600 rounded-lg transition-all duration-200 group"
                  >
                    <svg class="item-icon w-5 h-5 text-gray-400 group-hover:text-red-500 transition-colors flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                    </svg>
                    <span>{{ 'ADMIN.HEADER.ABOUT_APP' | translate }}</span>
                  </button>

                  <!-- Logout Button -->
                  <button
                    (click)="handleMenuClick('logout')"
                    class="dropdown-item w-full flex items-center gap-3 px-3 py-2 text-sm text-red-600 hover:bg-red-50 hover:text-red-600 rounded-lg transition-all duration-200 group"
                  >
                    <svg class="item-icon w-5 h-5 text-red-400 group-hover:text-red-500 transition-colors flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z" clip-rule="evenodd"></path>
                    </svg>
                    <span>{{ 'ADMIN.HEADER.LOGOUT' | translate }}</span>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Notifications Component -->
        <app-notifications></app-notifications>

        <!-- Language Dropdown -->
        <div class="relative language-dropdown-container">
          <!-- Language Button -->
          <button
            (click)="toggleLanguageDropdown()"
            class="dropdown-button relative flex items-center gap-2 p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-full transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
            [class.text-blue-600]="languageDropdownOpen"
            [class.bg-blue-50]="languageDropdownOpen"
            [class.active]="languageDropdownOpen"
          >
            <!-- Globe Icon -->
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="1.5"/>
              <path d="M3 12H21" stroke="currentColor" stroke-width="1.5"/>
              <path d="M12 3C14.5 6 14.5 18 12 21C9.5 18 9.5 6 12 3Z" stroke="currentColor" stroke-width="1.5"/>
            </svg>

            <!-- Current Language Text -->
            <span class="text-sm font-medium">
              {{ getCurrentLanguageDisplayName() }}
            </span>

            <!-- Dropdown Arrow -->
            <svg
              class="dropdown-arrow w-4 h-4 transition-transform duration-200"
              [class.rotate-180]="languageDropdownOpen"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>

          <!-- Language Dropdown Menu -->
          <div
            *ngIf="languageDropdownOpen"
            class="dropdown-menu absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-2xl border border-gray-100 z-50 overflow-hidden"
            [@dropdownAnimation]
            (click)="onDropdownClick($event)"
          >
            <!-- Header -->
            <div class="dropdown-header px-4 py-3 border-b border-gray-100 bg-gray-50 rounded-t-lg">
              <h3 class="text-sm font-semibold text-gray-800">
                {{ 'ADMIN.HEADER.SELECT_LANGUAGE' | translate }}
              </h3>
            </div>

            <!-- Languages List -->
            <div class="dropdown-content py-2">
              <!-- Arabic Option -->
              <button
                class="dropdown-item language-option w-full flex items-center gap-3 px-4 py-3 text-right hover:bg-gray-50 transition-colors duration-150 focus:outline-none focus:bg-gray-50"
                [class.bg-blue-50]="isActiveLanguage('ar')"
                [class.border-r-2]="isActiveLanguage('ar')"
                [class.border-blue-500]="isActiveLanguage('ar')"
                [class.active]="isActiveLanguage('ar')"
                (click)="ChangeLanguage('rtl')"
                [disabled]="isActiveLanguage('ar')"
              >
                <!-- Arabic Flag -->
                <div class="flag-container w-6 h-6 rounded-full flex items-center justify-center text-lg">
                  <img src="https://flagsapi.com/EG/flat/64.png" alt="Arabic" class="w-full h-full rounded-full object-cover">
                </div>

                <div class="flex-1 text-right">
                  <div class="text-sm font-medium text-gray-900 font-arabic">العربية</div>
                  <div class="text-xs text-gray-500">{{ 'ADMIN.HEADER.ARABIC' | translate }}</div>
                </div>

                <!-- Active Indicator -->
                <div class="active-indicator flex items-center">
                  <svg
                    *ngIf="isActiveLanguage('ar')"
                    class="w-4 h-4 text-blue-600"
                    fill="currentColor"
                    viewBox="0 0 20 20"
                  >
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                  </svg>
                </div>
              </button>

              <!-- English Option -->
              <button
                class="dropdown-item language-option w-full flex items-center gap-3 px-4 py-3 text-left hover:bg-gray-50 transition-colors duration-150 focus:outline-none focus:bg-gray-50"
                [class.bg-blue-50]="isActiveLanguage('en')"
                [class.border-r-2]="isActiveLanguage('en')"
                [class.border-blue-500]="isActiveLanguage('en')"
                [class.active]="isActiveLanguage('en')"
                (click)="ChangeLanguage('ltr')"
                [disabled]="isActiveLanguage('en')"
              >
                <!-- English Flag -->
                <div class="flag-container w-6 h-6 rounded-full flex items-center justify-center text-lg">
                  <img src="https://flagsapi.com/GB/flat/64.png" alt="English" class="w-full h-full rounded-full object-cover">
                </div>

                <div class="flex-1 text-left">
                  <div class="text-sm font-medium text-gray-900 font-english">English</div>
                  <div class="text-xs text-gray-500">{{ 'ADMIN.HEADER.ENGLISH' | translate }}</div>
                </div>

                <!-- Active Indicator -->
                <div class="active-indicator flex items-center">
                  <svg
                    *ngIf="isActiveLanguage('en')"
                    class="w-4 h-4 text-blue-600"
                    fill="currentColor"
                    viewBox="0 0 20 20"
                  >
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                  </svg>
                </div>
              </button>
            </div>

            <!-- Footer -->
            <div class="dropdown-footer px-4 py-2 bg-gray-50 border-t border-gray-100 rounded-b-lg">
              <p class="text-xs text-gray-500 text-center">
                {{ 'ADMIN.HEADER.PAGE_WILL_RELOAD' | translate }}
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- User Profile Section -->
      <div class="header-user_profile flex gap-[10px] relative items-center cursor-pointer">
        <div class="flex items-center gap-1">
          <span class="text-sm font-medium text-gray-800">Abdelrahim</span>
        </div>
        <div>
          <img
            src="./assets/images/user.png"
            alt="User Avatar"
            class="w-[67px] h-[67px] rounded-full border border-gray-300 transition-all duration-200 hover:border-blue-300"
          />
        </div>
      </div>
    </div>
  </div>
</header>
